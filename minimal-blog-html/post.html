<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bài viết — Minimal Focus</title>
    <meta name="description" content="" id="meta-description" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <!-- Marked.js: Render Markdown thành HTML -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
    <a href="#main-content" class="skip-link">Bỏ qua đến nội dung chính</a>

    <div id="header"></div>

    <main id="main-content" class="post-container">
        <article class="post-article" id="post-content">
            <!-- Cover Image (ẩn mặc định, hiện nếu có) -->
            <img id="post-cover" class="post-cover"
                style="display:none; width:100%; border-radius:12px; margin-bottom:2rem;" alt="" />

            <header class="post-header">
                <h1 id="post-title" style="min-height: 2rem;"></h1>
                <div id="post-meta" class="post-meta"
                    style="display:flex; gap: 0.5rem; color: var(--muted); font-size: var(--fs-meta);"></div>
                <div id="post-tags" class="post-tags"
                    style="margin-top: 0.75rem; display:flex; gap: 0.5rem; flex-wrap:wrap;"></div>
            </header>

            <div id="post-body" class="prose" style="min-height: 4rem;">
                <p style="color: var(--muted)">Đang tải nội dung...</p>
            </div>
        </article>

        <!-- Chia sẻ Facebook -->
        <div class="share-section" style="margin: 2rem 0; padding-top: 1.5rem; border-top: 1px solid var(--border);">
            <button
                onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(window.location.href), '_blank', 'width=600,height=400')"
                class="share-btn"
                style="display:inline-flex; align-items:center; gap:0.5rem; padding: 0.625rem 1.25rem; background: #1877F2; color: white; border: none; border-radius: 8px; font-size: var(--fs-meta); font-weight: 600; cursor: pointer; font-family: var(--font-body);">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="white">
                    <path
                        d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                </svg>
                Chia sẻ lên Facebook
            </button>
        </div>

        <!-- Native Comments Section -->
        <section class="comment-section">
            <h2 class="comment-section__title">
                Bình luận <span id="comments-count" class="comment-section__count"></span>
            </h2>

            <!-- Form gửi bình luận -->
            <div id="comment-form-wrapper">
                <form id="commentForm" class="comment-section__form" novalidate>
                    <div class="comment-section__form-row">
                        <div class="comment-section__field">
                            <label for="authorName">Tên của bạn *</label>
                            <input id="authorName" name="authorName" type="text" placeholder="Nguyễn Văn A" required
                                maxlength="100" />
                        </div>
                        <div class="comment-section__field">
                            <label for="authorEmail">Email *</label>
                            <input id="authorEmail" name="authorEmail" type="email" placeholder="email@example.com"
                                required maxlength="200" />
                        </div>
                    </div>
                    <div class="comment-section__field" style="position: relative">
                        <label for="content">Nội dung *</label>
                        <textarea id="content" name="content" rows="4"
                            placeholder="Chia sẻ suy nghĩ của bạn về bài viết này..." required
                            maxlength="2000"></textarea>
                        <span class="comment-section__charcount" id="charCount">0/2000</span>
                    </div>
                    <button type="submit" class="comment-section__submit">Gửi bình luận</button>
                </form>
            </div>

            <!-- Danh sách bình luận đã duyệt -->
            <div id="comments-list" class="comment-section__list" style="margin-top: 2rem;">
                <p class="comment-section__loading">Đang tải bình luận...</p>
            </div>
        </section>
    </main>

    <div id="footer"></div>

    <script type="module">
        import { loadPost, submitComment } from './js/post.js'

        loadPost()

        // Gắn handler cho form
        document.getElementById('commentForm')?.addEventListener('submit', submitComment)

        // Char count
        document.getElementById('content')?.addEventListener('input', (e) => {
            document.getElementById('charCount').textContent = `${e.target.value.length}/2000`
        })
    </script>
</body>

</html>